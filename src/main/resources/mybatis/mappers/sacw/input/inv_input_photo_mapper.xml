<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
        namespace="com.zhixin.zhfz.sacw.dao.inrecordphoto.IInRecordPhotoMapper">

    <resultMap id="inRecordPhotoResultMap" type="com.zhixin.zhfz.sacw.entity.InRecordPhotoEntity">
        <id property="id" column="id"/>
        <result property="inputRecordId" column="input_record_id"/>
        <result property="involvedId" column="involved_id"/>
        <result property="url" column="url"/>
        <result property="uuid" column="uuid"/>
        <result property="fileName" column="file_name"/>
        <result property="createdTime" column="created_time"/>
        <result column="op_pid" property="op_pid" jdbcType="VARCHAR"/>
        <result column="op_user_id" property="op_user_id" jdbcType="INTEGER"/>
        <!-- å¤– -->
        <result property="involvedIdName" column="involvedIdName"/>
        <result property="warehouseId" column="warehouse_id"/>
    </resultMap>

    <!-- id is same to interface'methmod -->
    <select id="listInRecordPhoto" resultMap="inRecordPhotoResultMap" parameterType="java.util.Map">
		select * from sa_input_record where involved_id = #{involvedId}  limit 1
	</select>

    <select id="count" resultType="java.lang.Integer" parameterType="java.util.Map">
		select count(1) from sa_input_record where involved_id = #{involvedId}
	</select>

    <insert id="insertInRecordPhoto" parameterType="com.zhixin.zhfz.sacw.entity.InRecordPhotoEntity">
		insert into sa_input_photo (input_record_id,involved_id,url,uuid,file_name,op_pid,op_user_id,created_time)
		values (#{inputRecordId},#{involvedId},#{url},#{uuid},#{fileName},#{op_pid},#{op_user_id},now())
	</insert>

    <delete id="deleteInRecordPhoto" parameterType="int">

    </delete>


    <select id="listInRecordPhotoById" resultMap="inRecordPhotoResultMap" parameterType="java.util.Map">
        select a.*,b.warehouse_id from sa_input_photo a,sa_involved b where
        a.involved_id = b.id
        <if test="invId !=null and invId !=''">
            AND a.involved_id = #{invId}
        </if>

    </select>


</mapper>